{"code":"Object.defineProperty(exports, \"__esModule\", { value: true });\r\nvar meteor_rxjs_1 = require(\"meteor-rxjs\");\r\nvar jalik_ufs_1 = require(\"meteor/jalik:ufs\");\r\nexports.Images = new meteor_rxjs_1.MongoObservable.Collection('images');\r\nexports.Thumbs = new meteor_rxjs_1.MongoObservable.Collection('thumbs');\r\nfunction loggedIn(userId) {\r\n    return !!userId;\r\n}\r\nexports.ThumbsStore = new jalik_ufs_1.UploadFS.store.GridFS({\r\n    collection: exports.Thumbs.collection,\r\n    name: 'thumbs',\r\n    permissions: new jalik_ufs_1.UploadFS.StorePermissions({\r\n        insert: loggedIn,\r\n        update: loggedIn,\r\n        remove: loggedIn\r\n    }),\r\n    transformWrite: function (from, to, fileId, file) {\r\n        var gm = require('gm'); // Resize to 32x32\r\n        gm(from, file.name)\r\n            .resize(32, 32)\r\n            .gravity('Center')\r\n            .extent(32, 32)\r\n            .quality(75)\r\n            .stream()\r\n            .pipe(to);\r\n    }\r\n});\r\nexports.ImagesStore = new jalik_ufs_1.UploadFS.store.GridFS({\r\n    collection: exports.Images.collection,\r\n    name: 'images',\r\n    filter: new jalik_ufs_1.UploadFS.Filter({\r\n        contentTypes: ['image/*']\r\n    }),\r\n    copyTo: [exports.ThumbsStore],\r\n    permissions: new jalik_ufs_1.UploadFS.StorePermissions({\r\n        insert: loggedIn,\r\n        update: loggedIn,\r\n        remove: loggedIn\r\n    })\r\n});\r\n//# sourceMappingURL=images.collection.js.map","sourceMap":{"version":3,"file":"images.collection.js","sourceRoot":"","sources":["both/collections/images.collection.ts"],"names":[],"mappings":";AAAA,2CAA8C;AAE9C,8CAA4C;AAG/B,QAAA,MAAM,GAAG,IAAI,6BAAe,CAAC,UAAU,CAAQ,QAAQ,CAAC,CAAC;AACzD,QAAA,MAAM,GAAG,IAAI,6BAAe,CAAC,UAAU,CAAQ,QAAQ,CAAC,CAAC;AAEtE,kBAAkB,MAAM;IACvB,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC;AACjB,CAAC;AAEY,QAAA,WAAW,GAAG,IAAI,oBAAQ,CAAC,KAAK,CAAC,MAAM,CAAC;IACpD,UAAU,EAAE,cAAM,CAAC,UAAU;IAC7B,IAAI,EAAE,QAAQ;IACd,WAAW,EAAE,IAAI,oBAAQ,CAAC,gBAAgB,CAAC;QAC1C,MAAM,EAAE,QAAQ;QAChB,MAAM,EAAE,QAAQ;QAChB,MAAM,EAAE,QAAQ;KAChB,CAAC;IACF,cAAc,YAAE,IAAI,EAAE,EAAE,EAAE,MAAM,EAAE,IAAI;QACrC,IAAM,EAAE,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,kBAAkB;QAE5C,EAAE,CAAG,IAAI,EAAE,IAAI,CAAC,IAAI,CAAE;aACpB,MAAM,CAAC,EAAE,EAAE,EAAE,CAAC;aACd,OAAO,CAAC,QAAQ,CAAC;aACjB,MAAM,CAAC,EAAE,EAAE,EAAE,CAAC;aACd,OAAO,CAAC,EAAE,CAAC;aACX,MAAM,EAAE;aACR,IAAI,CAAC,EAAE,CAAC,CAAA;IACX,CAAC;CACD,CAAC,CAAC;AAEU,QAAA,WAAW,GAAG,IAAI,oBAAQ,CAAC,KAAK,CAAC,MAAM,CAAC;IACpD,UAAU,EAAE,cAAM,CAAC,UAAU;IAC7B,IAAI,EAAE,QAAQ;IACd,MAAM,EAAE,IAAI,oBAAQ,CAAC,MAAM,CAAC;QAC3B,YAAY,EAAE,CAAC,SAAS,CAAC;KACzB,CAAC;IACF,MAAM,EAAE,CAAE,mBAAW,CAAE;IACvB,WAAW,EAAE,IAAI,oBAAQ,CAAC,gBAAgB,CAAC;QAC1C,MAAM,EAAE,QAAQ;QAChB,MAAM,EAAE,QAAQ;QAChB,MAAM,EAAE,QAAQ;KAChB,CAAC;CACF,CAAC,CAAC","sourcesContent":["import { MongoObservable } from 'meteor-rxjs';\nimport { Meteor } from 'meteor/meteor';\nimport { UploadFS } from 'meteor/jalik:ufs';\nimport { Thumb, Image } from '/both/models/image.model';\n\nexport const Images = new MongoObservable.Collection<Image>('images');\nexport const Thumbs = new MongoObservable.Collection<Thumb>('thumbs');\n\nfunction loggedIn(userId) {\n\treturn !!userId;\n}\n\nexport const ThumbsStore = new UploadFS.store.GridFS({\n\tcollection: Thumbs.collection,\n\tname: 'thumbs',\n\tpermissions: new UploadFS.StorePermissions({\n\t\tinsert: loggedIn,\n\t\tupdate: loggedIn,\n\t\tremove: loggedIn\n\t}),\n\ttransformWrite( from, to, fileId, file ) {\n\t\tconst gm = require('gm'); // Resize to 32x32\n\n\t\tgm ( from, file.name )\n\t\t\t.resize(32, 32)\n\t\t\t.gravity('Center')\n\t\t\t.extent(32, 32)\n\t\t\t.quality(75)\n\t\t\t.stream()\n\t\t\t.pipe(to)\n\t}\n});\n\nexport const ImagesStore = new UploadFS.store.GridFS({\n\tcollection: Images.collection,\n\tname: 'images',\n\tfilter: new UploadFS.Filter({\n\t\tcontentTypes: ['image/*']\n\t}),\n\tcopyTo: [ ThumbsStore ],\n\tpermissions: new UploadFS.StorePermissions({\n\t\tinsert: loggedIn,\n\t\tupdate: loggedIn,\n\t\tremove: loggedIn\n\t})\n});"]},"version":"1","isExternal":true,"dependencies":{"modules":["/both/models/image.model.ts"],"refFiles":[],"refTypings":[],"mappings":[{"modulePath":"meteor-rxjs","resolvedPath":null,"external":false,"resolved":false},{"modulePath":"meteor/meteor","resolvedPath":null,"external":false,"resolved":false},{"modulePath":"meteor/jalik:ufs","resolvedPath":null,"external":false,"resolved":false},{"modulePath":"/both/models/image.model","resolvedPath":"/both/models/image.model","external":false,"resolved":true}]},"diagnostics":{"syntacticErrors":[],"semanticErrors":[{"code":2307,"fileName":"both/collections/images.collection.ts","message":"Cannot find module 'meteor-rxjs'.","line":1,"column":33},{"code":2307,"fileName":"both/collections/images.collection.ts","message":"Cannot find module 'meteor/meteor'.","line":2,"column":24},{"code":2304,"fileName":"both/collections/images.collection.ts","message":"Cannot find name 'require'.","line":22,"column":14}]},"hash":"8fff0c603318b3c2fd38620ab6e151a9f3d8b7b0"}